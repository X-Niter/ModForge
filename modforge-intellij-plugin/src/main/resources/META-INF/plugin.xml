<?xml version="1.0" encoding="UTF-8"?>
<idea-plugin>
    <id>com.modforge.intellij.plugin</id>
    <name>ModForge</name>
    <vendor email="support@modforge.dev" url="https://modforge.dev">ModForge</vendor>
    <description><![CDATA[
        <p>ModForge is an AI-powered development platform for Minecraft mods.</p>
        <p>Features:</p>
        <ul>
            <li>AI-assisted code generation with OpenAI integration</li>
            <li>Continuous development mode that automatically fixes errors</li>
            <li>Pattern recognition to reduce API costs</li>
            <li>Documentation generation and code explanation</li>
            <li>Support for multiple mod loaders (Forge, Fabric, Quilt)</li>
        </ul>
    ]]></description>

    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.java</depends>

    <extensions defaultExtensionNs="com.intellij">
        <!-- Services -->
        <applicationService serviceImplementation="com.modforge.intellij.plugin.settings.ModForgeSettings"/>
        <applicationService serviceImplementation="com.modforge.intellij.plugin.ai.AIServiceManager"/>
        <applicationService serviceImplementation="com.modforge.intellij.plugin.ai.PatternRecognitionService"/>

        <projectService serviceImplementation="com.modforge.intellij.plugin.services.AutonomousCodeGenerationService"/>
        <projectService serviceImplementation="com.modforge.intellij.plugin.services.ContinuousDevelopmentService"/>
        <projectService serviceImplementation="com.modforge.intellij.plugin.listeners.ModForgeCompilationListener"/>

        <!-- Tool Window -->
        <toolWindow id="ModForge" 
                    icon="AllIcons.General.Modified" 
                    anchor="right" 
                    factoryClass="com.modforge.intellij.plugin.ui.toolwindow.ModForgeToolWindowFactory"/>

        <!-- Settings -->
        <applicationConfigurable parentId="tools" 
                                 instance="com.modforge.intellij.plugin.settings.ModForgeSettingsConfigurable" 
                                 id="com.modforge.intellij.plugin.settings.ModForgeSettingsConfigurable" 
                                 displayName="ModForge"/>
    </extensions>

    <applicationListeners>
        <!-- Project listeners -->
    </applicationListeners>

    <projectListeners>
        <!-- Register compilation listener -->
        <listener class="com.modforge.intellij.plugin.listeners.ModForgeCompilationListener"
                  topic="com.intellij.openapi.compiler.CompilationStatusListener"/>
    </projectListeners>

    <actions>
        <!-- Main Actions -->
        <group id="ModForge.MainMenu" text="ModForge" description="ModForge actions" popup="true">
            <add-to-group group-id="ToolsMenu" anchor="last"/>
            <action id="ModForge.ShowToolWindow" 
                    class="com.modforge.intellij.plugin.actions.ShowToolWindowAction" 
                    text="Show ModForge Tool Window" 
                    description="Show ModForge tool window"/>
            <action id="ModForge.OpenSettings" 
                    class="com.modforge.intellij.plugin.actions.OpenSettingsAction" 
                    text="Open ModForge Settings" 
                    description="Open ModForge settings"/>
            <separator/>
            <action id="ModForge.GenerateCode" 
                    class="com.modforge.intellij.plugin.actions.GenerateCodeAction" 
                    text="Generate Code" 
                    description="Generate code using AI"/>
            <action id="ModForge.FixErrors" 
                    class="com.modforge.intellij.plugin.actions.FixErrorsAction" 
                    text="Fix Errors" 
                    description="Fix errors using AI"/>
            <action id="ModForge.GenerateDocumentation" 
                    class="com.modforge.intellij.plugin.actions.GenerateDocumentationAction" 
                    text="Generate Documentation" 
                    description="Generate documentation using AI"/>
            <action id="ModForge.ExplainCode" 
                    class="com.modforge.intellij.plugin.actions.ExplainCodeAction" 
                    text="Explain Code" 
                    description="Explain code using AI"/>
            <separator/>
            <action id="ModForge.ToggleContinuousDevelopment" 
                    class="com.modforge.intellij.plugin.actions.ToggleContinuousDevelopmentAction" 
                    text="Toggle Continuous Development" 
                    description="Toggle continuous development"/>
            <action id="ModForge.TogglePatternRecognition" 
                    class="com.modforge.intellij.plugin.actions.TogglePatternRecognitionAction" 
                    text="Toggle Pattern Recognition" 
                    description="Toggle pattern recognition"/>
        </group>

        <!-- Editor Actions -->
        <group id="ModForge.EditorPopupMenu" text="ModForge" description="ModForge actions" popup="true">
            <add-to-group group-id="EditorPopupMenu" anchor="last"/>
            <action id="ModForge.GenerateCodeEditor" 
                    class="com.modforge.intellij.plugin.actions.GenerateCodeAction" 
                    text="Generate Code" 
                    description="Generate code using AI"/>
            <action id="ModForge.FixErrorsEditor" 
                    class="com.modforge.intellij.plugin.actions.FixErrorsAction" 
                    text="Fix Errors" 
                    description="Fix errors using AI"/>
            <action id="ModForge.GenerateDocumentationEditor" 
                    class="com.modforge.intellij.plugin.actions.GenerateDocumentationAction" 
                    text="Generate Documentation" 
                    description="Generate documentation using AI"/>
            <action id="ModForge.ExplainCodeEditor" 
                    class="com.modforge.intellij.plugin.actions.ExplainCodeAction" 
                    text="Explain Code" 
                    description="Explain code using AI"/>
        </group>
    </actions>
</idea-plugin>