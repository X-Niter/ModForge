<?xml version="1.0" encoding="UTF-8"?>
<idea-plugin>
    <id>com.modforge.intellij.plugin</id>
    <name>ModForge</name>
    <vendor email="support@modforge.dev" url="https://modforge.dev">ModForge</vendor>
    <name>ModForge</name>
    <vendor email="support@modforge.dev" url="https://modforge.dev">ModForge</vendor>
    <description><![CDATA[
        <p>ModForge is an AI-powered development platform for Minecraft mods.</p>
        <p>Features:</p>
        <ul>
            <li>AI-assisted code generation with OpenAI integration</li>
            <li>Continuous development mode that automatically fixes errors</li>
            <li>Pattern recognition to reduce API costs</li>
            <li>Documentation generation and code explanation</li>
            <li>Support for multiple mod loaders (Forge, Fabric, Quilt)</li>
        </ul>
    ]]></description>

    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.java</depends>

    <extensions defaultExtensionNs="com.intellij">
        <!-- Services -->
        <applicationService serviceImplementation="com.modforge.intellij.plugin.settings.ModForgeSettings"/>
        <applicationService serviceImplementation="com.modforge.intellij.plugin.ai.PatternRecognitionService"/>

        <projectService serviceImplementation="com.modforge.intellij.plugin.services.AutonomousCodeGenerationService"/>
        <projectService serviceImplementation="com.modforge.intellij.plugin.services.ContinuousDevelopmentService"/>
        <projectService serviceImplementation="com.modforge.intellij.plugin.services.ModForgeProjectService"/>
        <projectService serviceImplementation="com.modforge.intellij.plugin.listeners.ModForgeCompilationListener"/>
        
        <!-- Startup Activities -->
        <postStartupActivity implementation="com.modforge.intellij.plugin.startup.AuthenticationStartupActivity"/>
        
        <!-- Settings -->
        <applicationConfigurable 
            parentId="tools" 
            instance="com.modforge.intellij.plugin.settings.ModForgeSettingsConfigurable" 
            id="com.modforge.intellij.plugin.settings.ModForgeSettingsConfigurable" 
            displayName="ModForge" 
            nonDefaultProject="true"/>
            
        <!-- Notification Groups -->
        <notificationGroup id="ModForge Notifications" 
                          displayType="BALLOON" 
                          toolWindowId="ModForge"
                          isLogByDefault="true"/>

        <!-- Tool Window -->
        <toolWindow id="ModForge" 
                    icon="AllIcons.General.Modified" 
                    anchor="right" 
                    factoryClass="com.modforge.intellij.plugin.ui.toolwindow.ModForgeToolWindowFactory"/>

        <!-- Settings -->
        <applicationConfigurable parentId="tools" 
                                 instance="com.modforge.intellij.plugin.settings.ModForgeSettingsConfigurable" 
                                 id="com.modforge.intellij.plugin.settings.ModForgeSettingsConfigurable" 
                                 displayName="ModForge"/>
                                 
        <!-- Startup Activity -->
        <postStartupActivity implementation="com.modforge.intellij.plugin.services.ModForgeProjectService$ProjectStartupActivity"/>
    </extensions>

    <projectListeners>
        <!-- Register compilation listener -->
        <listener class="com.modforge.intellij.plugin.listeners.ModForgeCompilationListener"
                  topic="com.intellij.openapi.compiler.CompilationStatusListener"/>
    </projectListeners>

    <actions>
        <!-- Main Actions -->
        <group id="ModForge.MainMenu" text="ModForge" description="ModForge actions" popup="true">
            <add-to-group group-id="ToolsMenu" anchor="last"/>
            <action id="ModForge.ShowToolWindow" 
                    class="com.modforge.intellij.plugin.actions.ShowToolWindowAction" 
                    text="Show ModForge Tool Window" 
                    description="Show ModForge tool window"/>
            <action id="ModForge.OpenSettings" 
                    class="com.modforge.intellij.plugin.actions.OpenSettingsAction" 
                    text="Open ModForge Settings" 
                    description="Open ModForge settings"/>
            <action id="ModForge.Login" 
                    class="com.modforge.intellij.plugin.actions.LoginAction" 
                    text="Login to ModForge" 
                    description="Log in to ModForge server"/>
            <action id="ModForge.Logout" 
                    class="com.modforge.intellij.plugin.actions.LogoutAction" 
                    text="Logout from ModForge" 
                    description="Log out from ModForge server"/>
            <action id="ModForge.VerifyAuthentication" 
                    class="com.modforge.intellij.plugin.actions.VerifyAuthenticationAction" 
                    text="Verify Authentication" 
                    description="Verify authentication status with ModForge server"/>
            <action id="ModForge.TestAuthEndpoints" 
                    class="com.modforge.intellij.plugin.actions.TestAuthEndpointsAction" 
                    text="Test Authentication Endpoints" 
                    description="Test all authentication endpoints with token auth"/>
            <action id="ModForge.TestTokenAuth" 
                    class="com.modforge.intellij.plugin.actions.TestTokenAuthAction" 
                    text="Test Token Authentication" 
                    description="Test token-based authentication with direct HTTP requests"/>
            <action id="ModForge.TestCompleteAuthFlow" 
                    class="com.modforge.intellij.plugin.actions.TestCompleteAuthFlowAction" 
                    text="Test Complete Auth Flow" 
                    description="Test the complete authentication flow from username/password to token"/>
            <separator/>
            <action id="ModForge.GenerateCode" 
                    class="com.modforge.intellij.plugin.actions.GenerateCodeAction" 
                    text="Generate Code" 
                    description="Generate code using AI"/>
            <action id="ModForge.FixErrors" 
                    class="com.modforge.intellij.plugin.actions.FixErrorsAction" 
                    text="Fix Errors" 
                    description="Fix errors using AI"/>
            <action id="ModForge.GenerateDocumentation" 
                    class="com.modforge.intellij.plugin.actions.GenerateDocumentationAction" 
                    text="Generate Documentation" 
                    description="Generate documentation using AI"/>
            <action id="ModForge.ExplainCode" 
                    class="com.modforge.intellij.plugin.actions.ExplainCodeAction" 
                    text="Explain Code" 
                    description="Explain code using AI"/>
            <separator/>
            <action id="ModForge.ToggleContinuousDevelopment" 
                    class="com.modforge.intellij.plugin.actions.ToggleContinuousDevelopmentAction" 
                    text="Toggle Continuous Development" 
                    description="Toggle continuous development"/>
            <action id="ModForge.TogglePatternRecognition" 
                    class="com.modforge.intellij.plugin.actions.TogglePatternRecognitionAction" 
                    text="Toggle Pattern Recognition" 
                    description="Toggle pattern recognition"/>
        </group>

        <!-- Editor Actions -->
        <group id="ModForge.EditorPopupMenu" text="ModForge" description="ModForge actions" popup="true">
            <add-to-group group-id="EditorPopupMenu" anchor="last"/>
            <action id="ModForge.GenerateCodeEditor" 
                    class="com.modforge.intellij.plugin.actions.GenerateCodeAction" 
                    text="Generate Code" 
                    description="Generate code using AI"/>
            <action id="ModForge.FixErrorsEditor" 
                    class="com.modforge.intellij.plugin.actions.FixErrorsAction" 
                    text="Fix Errors" 
                    description="Fix errors using AI"/>
            <action id="ModForge.GenerateDocumentationEditor" 
                    class="com.modforge.intellij.plugin.actions.GenerateDocumentationAction" 
                    text="Generate Documentation" 
                    description="Generate documentation using AI"/>
            <action id="ModForge.ExplainCodeEditor" 
                    class="com.modforge.intellij.plugin.actions.ExplainCodeAction" 
                    text="Explain Code" 
                    description="Explain code using AI"/>
        </group>
        
        <!-- Toolbar Actions -->
        <group id="ModForge.ToolbarActions" text="ModForge Toolbar Actions" description="ModForge toolbar actions">
            <action id="ModForge.LoginToolbar" 
                    class="com.modforge.intellij.plugin.actions.LoginAction" 
                    text="Login to ModForge" 
                    description="Log in to ModForge server"
                    icon="AllIcons.General.User"/>
            <action id="ModForge.LogoutToolbar" 
                    class="com.modforge.intellij.plugin.actions.LogoutAction" 
                    text="Logout from ModForge" 
                    description="Log out from ModForge server"
                    icon="AllIcons.Actions.Exit"/>
            <action id="ModForge.VerifyAuthenticationToolbar" 
                    class="com.modforge.intellij.plugin.actions.VerifyAuthenticationAction" 
                    text="Verify Authentication" 
                    description="Verify authentication status with ModForge server"
                    icon="AllIcons.General.BalloonInformation"/>
            <action id="ModForge.TestTokenAuthToolbar" 
                    class="com.modforge.intellij.plugin.actions.TestTokenAuthAction" 
                    text="Test Token Authentication" 
                    description="Test token-based authentication with direct HTTP requests"
                    icon="AllIcons.General.Web"/>
            <action id="ModForge.TestCompleteAuthFlowToolbar" 
                    class="com.modforge.intellij.plugin.actions.TestCompleteAuthFlowAction" 
                    text="Test Complete Auth Flow" 
                    description="Test the complete authentication flow from username/password to token"
                    icon="AllIcons.General.ExternalTools"/>
            <separator/>
            <action id="ModForge.GenerateCodeToolbar" 
                    class="com.modforge.intellij.plugin.actions.GenerateCodeAction" 
                    text="Generate Code" 
                    description="Generate code using AI"
                    icon="AllIcons.Actions.AddFile"/>
            <action id="ModForge.FixErrorsToolbar" 
                    class="com.modforge.intellij.plugin.actions.FixErrorsAction" 
                    text="Fix Errors" 
                    description="Fix errors using AI"
                    icon="AllIcons.Actions.QuickfixBulb"/>
            <action id="ModForge.GenerateDocumentationToolbar" 
                    class="com.modforge.intellij.plugin.actions.GenerateDocumentationAction" 
                    text="Generate Documentation" 
                    description="Generate documentation using AI"
                    icon="AllIcons.Actions.Help"/>
            <action id="ModForge.ToggleContinuousDevelopmentToolbar" 
                    class="com.modforge.intellij.plugin.actions.ToggleContinuousDevelopmentAction" 
                    text="Toggle Continuous Development" 
                    description="Toggle continuous development"
                    icon="AllIcons.Actions.Execute"/>
        </group>
    </actions>
</idea-plugin>
